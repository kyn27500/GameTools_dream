# -*- coding: utf-8 -*- # svn 工具# author: kongyanan# date : 2016-11-03import osimport sysimport reimport subprocess# svn路径(测试使用)protoPath = "/Users/koba/Documents/work/common/protofile/fishing"pbPath = "/Users/koba/Documents/work/FishingGame_Client/modules/fishing/proto"# 执行系统命令def execSys(cmd):	p = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)	# for line in p.stdout.readlines():	#     print line,	retval = p.wait()	return retval,p.stdout.read()# 获取最新版本号def pull(pSvnPath):	cmd_svninfo = "cd "+pSvnPath+";git pull"	ret = execSys(cmd_svninfo)	if ret[0] == 0:		return ret[1]def commit(pSvnPath):	cmd_svninfo = "cd "+pSvnPath+";git add ./.;git commit -m\"robot commit\";git push"	ret = execSys(cmd_svninfo)	return retif __name__ == '__main__':	# 获取外部传入的参数	if len(sys.argv)==3:		protoPath = sys.argv[1]		pbPath = sys.argv[2]		# 更新excel SVN		pull(protoPath)		pull(pbPath)				execSys("sh "+ os.path.join(protoPath,"client.sh"))		ret=commit(pbPath)		if ret[0] == 0:			print "proto文件更新完毕"		else:			print ret[1]